{% extends "base.html" %}

{% block content %}
<div class="lobby">
    <h1>Ronin Mahjong</h1>
    <div class="lobby-header">
        <span class="username">{{ username }}</span>
        <form method="POST" action="/logout" style="display:inline">
            <button type="submit" class="btn btn-small">Logout</button>
        </form>
    </div>
    <div class="lobby-controls">
        <form method="POST" action="/rooms/new">
            <button type="submit" class="btn btn-primary">Create Room</button>
        </form>
        <a href="/" class="btn btn-secondary">Refresh</a>
    </div>

    {% if error %}
    <div class="lobby-status">
        <p class="error-message">{{ error }}</p>
    </div>
    {% endif %}

    <div class="games-list">
        {% if rooms %}
            {% for room in rooms %}
            <div class="game-item">
                <span class="game-id">{{ room.room_id }}</span>
                <span class="game-players">{{ room.player_count }}/{{ room.players_needed }} players</span>
                {% if room.player_count < room.players_needed %}
                <form method="POST" action="/rooms/{{ room.room_id }}/join" style="display:inline">
                    <button type="submit" class="btn btn-small">Join</button>
                </form>
                {% else %}
                <span class="game-full">Full</span>
                {% endif %}
            </div>
            {% endfor %}
        {% else %}
            <p class="empty-message">No rooms available. Create one!</p>
        {% endif %}
    </div>
</div>
{% endblock %}
